<%= javascript_include_tag ['jquery-1.3.2', 'application'] %>
$(document).ready(function() {
    $.ajaxSetup({
        'beforeSend': function (xhr) {
            xhr.setRequestHeader("Accept", "text/javascript")
        }
    });
    var submitButton = document.getElementsByName("Calculate");
    var calculatorCreated = false;
    $(submitButton).click(function () {

        if (calculatorCreated == false) {
            $.ajax({
                type: "POST",
                url: "/create"
            }).success(function (data) {
                calculatorCreated = true;
                console.log('CalculatorCreated');
                calculate($('#command').val());
            });

        }
        else
        {
            calculate($('#command').val());
        }
    });
    function calculate(command)
    {
        $.ajax({
            type: "PUT",
            url: "/update",
            data: {command: command}
        }).success(function (data) {
            console.log(data.state);
            var result = document.getElementsByClassName("result");
            $(result).text("Result is "+ data.state);
        });
    }
});

